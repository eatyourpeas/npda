{% extends 'dashboard/components/bases/base_card.html' %}
{% block card_title %}
  Patient Caracteristics
{% endblock card_title%}
{% block card_body %}

<div class="p-2">
  {% comment %} CARE {% endcomment %}
  <div class="flex flex-col mb-4">
    <h4 class='font-bold'>Care</h4>
    {% for kpi_label,values in charts.pt_characteristics_value_counts.data.care.items %}
      <div class="flex flex-col mt-2">
        <span class="tooltip text-start" data-tip='({{ values.count }} / {{ values.total }})'>
          <p class="rcpch_dark_blue text-sm">
            {% if kpi_label == 'kpi_4_total_t1dm_gte_12yo' %}
            Aged 12+
            {% elif kpi_label == 'kpi_5_total_t1dm_complete_year' %}
            Complete year of care
            {% elif kpi_label == 'kpi_6_total_t1dm_complete_year_gte_12yo' %}
            Aged 12+ with complete year of care
            {% endif %}
            : {{ values.pct }}%</p>
          <div
          class="py-2"
          hx-get="{% url 'get_colored_figures_chart_partial' colored=values.figures_coloured total_figures=5 %}"
          hx-trigger="load" hx-swap="innerHTML"></div>
        </span>
      </div>
    {% endfor %}
  </div>

  {% comment %} DIED / TRANSITIONED {% endcomment %}
  <div class="flex flex-col mb-4">
    <h4 class='font-bold'>Died or transitioned</h4>
    {% for kpi_label,values in charts.pt_characteristics_value_counts.data.died_or_transitioned.items %}
      <span class="tooltip text-start" data-tip='({{ values.count }} / {{ values.total }})'>
        <div class="flex flex-col mt-4">
          <p class="rcpch_dark_blue text-sm">
            {% if kpi_label == 'kpi_8_total_deaths' %}
              Died
            {% elif kpi_label == 'kpi_9_total_service_transitions' %}
              Transitioned
            {% endif %}
            : {{ values.pct }}%</p>
          <div
          class="py-2"
          hx-get="{% url 'get_colored_figures_chart_partial' colored=values.figures_coloured total_figures=5 %}"
          hx-trigger="load" hx-swap="innerHTML"></div>
        </div>
      </span>
    {% endfor %}
  </div>

  {% comment %} COMORBIDITY / TESTING {% endcomment %}
  <div class="flex flex-col mb-4">
    <h4 class='font-bold'>Comorbidity & Testing</h4>
    {% for kpi_label,values in charts.pt_characteristics_value_counts.data.comorbidity_and_testing.items %}
    <span class="tooltip text-start" data-tip='({{ values.count }} / {{ values.total }})'>
      <div class="flex flex-col mt-4">
        <p class="rcpch_dark_blue text-sm">
          {% if kpi_label == 'kpi_10_total_coeliacs' %}
            Coeliac disease
          {% elif kpi_label == 'kpi_11_total_thyroids' %}
            Thyroid disease
          {% elif kpi_label == 'kpi_12_total_ketone_test_equipment' %}
            Ketone testing
          {% endif %}
          : {{ values.pct }}%</p>
        <div
        class="py-2"
        hx-get="{% url 'get_colored_figures_chart_partial' colored=values.figures_coloured total_figures=5 %}"
        hx-trigger="load" hx-swap="innerHTML"></div>
      </div>
      </span>
    {% endfor %}
  </div>
</div>

{% endblock %}






